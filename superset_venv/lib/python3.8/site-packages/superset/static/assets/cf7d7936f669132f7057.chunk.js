"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[2197],{72197:(e,t,n)=>{n.r(t),n.d(t,{extractTreePathInfo:()=>u,default:()=>i});var r=n(78580),l=n.n(r),c=n(67294),a=n(63475),s=n(11965);const u=e=>(null!=e?e:[]).map((e=>(null==e?void 0:e.name)||"")).filter((e=>""!==e));function i(e){const{height:t,width:n,echartOptions:r,setDataMask:i,labelMap:h,selectedValues:o,formData:f,onContextMenu:d,refs:p,emitCrossFilters:g}=e,{columns:v}=f,w=(0,c.useCallback)((e=>{if(!g)return;const t=e.map((e=>h[e]));i({extraFormData:{filters:0!==e.length&&v?v.map(((e,n)=>{const r=t.map((e=>e[n]));return null==r?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:r}})):[]},filterState:{value:t.length?t:null,selectedValues:e.length?e:null}})}),[g,i,v,h]),m={click:e=>{const{treePathInfo:t}=e,n=u(t).join(","),r=Object.values(o);l()(r).call(r,n)?w(r.filter((e=>e!==n))):w([n])},contextmenu:e=>{if(d){e.event.stop();const{data:t}=e,{records:n}=t,r=u(e.treePathInfo),l=e.event.event,c=[];null!=v&&v.length&&r.forEach(((e,t)=>c.push({col:v[t],op:"==",val:n[t],formattedVal:e}))),d(l.clientX,l.clientY,c)}}};return(0,s.tZ)(a.Z,{refs:p,height:t,width:n,echartOptions:r,eventHandlers:m,selectedValues:o})}},63475:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(78580),l=n.n(r),c=n(67294),a=n(51995),s=n(31431),u=n(11965);const i=a.iK.div`
  height: ${e=>{let{height:t}=e;return t}};
  width: ${e=>{let{width:t}=e;return t}};
`;function h(e,t){let{width:n,height:r,echartOptions:a,eventHandlers:h,zrEventHandlers:o,selectedValues:f={},refs:d}=e;const p=(0,c.useRef)(null);d&&(d.divRef=p);const g=(0,c.useRef)(),v=(0,c.useMemo)((()=>Object.keys(f)||[]),[f]),w=(0,c.useRef)([]);(0,c.useImperativeHandle)(t,(()=>({getEchartInstance:()=>g.current}))),(0,c.useEffect)((()=>{p.current&&(g.current||(g.current=(0,s.S1)(p.current)),Object.entries(h||{}).forEach((e=>{var t,n;let[r,l]=e;null==(t=g.current)||t.off(r),null==(n=g.current)||n.on(r,l)})),Object.entries(o||{}).forEach((e=>{var t,n;let[r,l]=e;null==(t=g.current)||t.getZr().off(r),null==(n=g.current)||n.getZr().on(r,l)})),g.current.setOption(a,!0))}),[a,h,o]),(0,c.useEffect)((()=>{g.current&&(g.current.dispatchAction({type:"downplay",dataIndex:w.current.filter((e=>!l()(v).call(v,e)))}),v.length&&g.current.dispatchAction({type:"highlight",dataIndex:v}),w.current=v)}),[v]);const m=(0,c.useCallback)((e=>{let{width:t,height:n}=e;g.current&&g.current.resize({width:t,height:n})}),[]);return(0,c.useEffect)((()=>(m({width:n,height:r}),()=>{var e;return null==(e=g.current)?void 0:e.dispose()})),[]),(0,c.useLayoutEffect)((()=>{m({width:n,height:r})}),[n,r,m]),(0,u.tZ)(i,{ref:p,height:r,width:n})}const o=(0,c.forwardRef)(h)}}]);
//# sourceMappingURL=cf7d7936f669132f7057.chunk.js.map