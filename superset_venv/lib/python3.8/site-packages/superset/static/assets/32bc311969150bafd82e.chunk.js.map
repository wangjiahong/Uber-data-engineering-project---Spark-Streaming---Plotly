{"version":3,"file":"32bc311969150bafd82e.chunk.js","mappings":"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","sources":["webpack://superset/./src/dashboard/components/nativeFilters/FilterBar/keyValue.tsx","webpack://superset/./src/dashboard/components/FilterBoxMigrationModal.tsx","webpack://superset/./src/dashboard/styles.ts","webpack://superset/./src/dashboard/containers/DashboardPage.tsx","webpack://superset/./src/dashboard/util/injectCustomCss.ts","webpack://superset/./src/hooks/apiResources/charts.ts","webpack://superset/./src/hooks/apiResources/dashboards.ts","webpack://superset/./src/hooks/apiResources/schemas.ts","webpack://superset/./src/hooks/apiResources/tables.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { SupersetClient, logging } from '@superset-ui/core';\nimport { DashboardPermalinkValue } from 'src/dashboard/types';\n\nconst assembleEndpoint = (\n  dashId: string | number,\n  key?: string | null,\n  tabId?: string,\n) => {\n  let endpoint = `api/v1/dashboard/${dashId}/filter_state`;\n  if (key) {\n    endpoint = endpoint.concat(`/${key}`);\n  }\n  if (tabId) {\n    endpoint = endpoint.concat(`?tab_id=${tabId}`);\n  }\n  return endpoint;\n};\n\nexport const updateFilterKey = (\n  dashId: string,\n  value: string,\n  key: string,\n  tabId?: string,\n) =>\n  SupersetClient.put({\n    endpoint: assembleEndpoint(dashId, key, tabId),\n    jsonPayload: { value },\n  })\n    .then(r => r.json.message)\n    .catch(err => {\n      logging.error(err);\n      return null;\n    });\n\nexport const createFilterKey = (\n  dashId: string | number,\n  value: string,\n  tabId?: string,\n) =>\n  SupersetClient.post({\n    endpoint: assembleEndpoint(dashId, undefined, tabId),\n    jsonPayload: { value },\n  })\n    .then(r => r.json.key as string)\n    .catch(err => {\n      logging.error(err);\n      return null;\n    });\n\nexport const getFilterValue = (dashId: string | number, key?: string | null) =>\n  SupersetClient.get({\n    endpoint: assembleEndpoint(dashId, key),\n  })\n    .then(({ json }) => JSON.parse(json.value))\n    .catch(err => {\n      logging.error(err);\n      return null;\n    });\n\nexport const getPermalinkValue = (key: string) =>\n  SupersetClient.get({\n    endpoint: `/api/v1/dashboard/permalink/${key}`,\n  })\n    .then(({ json }) => json as DashboardPermalinkValue)\n    .catch(err => {\n      logging.error(err);\n      return null;\n    });\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FunctionComponent } from 'react';\nimport { styled, t } from '@superset-ui/core';\n\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\n\nconst StyledFilterBoxMigrationModal = styled(Modal)`\n  .modal-content {\n    height: 900px;\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n  }\n\n  .modal-header {\n    flex: 0 1 auto;\n  }\n\n  .modal-body {\n    flex: 1 1 auto;\n    overflow: auto;\n  }\n\n  .modal-footer {\n    flex: 0 1 auto;\n  }\n\n  .ant-modal-body {\n    overflow: auto;\n  }\n`;\n\ninterface FilterBoxMigrationModalProps {\n  onHide: () => void;\n  onClickReview: () => void;\n  onClickSnooze: () => void;\n  show: boolean;\n  hideFooter: boolean;\n}\n\nconst FilterBoxMigrationModal: FunctionComponent<FilterBoxMigrationModalProps> =\n  ({ onClickReview, onClickSnooze, onHide, show, hideFooter = false }) => (\n    <StyledFilterBoxMigrationModal\n      show={show}\n      onHide={onHide}\n      title={t('Ready to review filters in this dashboard?')}\n      hideFooter={hideFooter}\n      footer={\n        <>\n          <Button buttonSize=\"small\" onClick={onClickSnooze}>\n            {t('Remind me in 24 hours')}\n          </Button>\n          <Button buttonSize=\"small\" onClick={onHide}>\n            {t('Cancel')}\n          </Button>\n          <Button\n            buttonSize=\"small\"\n            buttonStyle=\"primary\"\n            onClick={onClickReview}\n          >\n            {t('Start Review')}\n          </Button>\n        </>\n      }\n      responsive\n    >\n      <div>\n        {t(\n          'filter_box will be deprecated ' +\n            'in a future version of Superset. ' +\n            'Please replace filter_box by dashboard filter components.',\n        )}\n      </div>\n    </StyledFilterBoxMigrationModal>\n  );\n\nexport default FilterBoxMigrationModal;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { css, SupersetTheme } from '@superset-ui/core';\n\nexport const headerStyles = (theme: SupersetTheme) => css`\n  body {\n    h1 {\n      font-weight: ${theme.typography.weights.bold};\n      line-height: 1.4;\n      font-size: ${theme.typography.sizes.xxl}px;\n      letter-spacing: -0.2px;\n      margin-top: ${theme.gridUnit * 3}px;\n      margin-bottom: ${theme.gridUnit * 3}px;\n    }\n\n    h2 {\n      font-weight: ${theme.typography.weights.bold};\n      line-height: 1.4;\n      font-size: ${theme.typography.sizes.xl}px;\n      margin-top: ${theme.gridUnit * 3}px;\n      margin-bottom: ${theme.gridUnit * 2}px;\n    }\n\n    h3,\n    h4,\n    h5,\n    h6 {\n      font-weight: ${theme.typography.weights.bold};\n      line-height: 1.4;\n      font-size: ${theme.typography.sizes.l}px;\n      letter-spacing: 0.2px;\n      margin-top: ${theme.gridUnit * 2}px;\n      margin-bottom: ${theme.gridUnit}px;\n    }\n  }\n`;\n\nexport const filterCardPopoverStyle = (theme: SupersetTheme) => css`\n  .filter-card-popover {\n    width: 240px;\n    padding: 0;\n    border-radius: 4px;\n\n    &.ant-popover-placement-bottom {\n      padding-top: ${theme.gridUnit}px;\n    }\n\n    &.ant-popover-placement-left {\n      padding-right: ${theme.gridUnit * 3}px;\n    }\n\n    .ant-popover-inner {\n      box-shadow: 0 0 8px rgb(0 0 0 / 10%);\n    }\n\n    .ant-popover-inner-content {\n      padding: ${theme.gridUnit * 4}px;\n    }\n\n    .ant-popover-arrow {\n      display: none;\n    }\n  }\n\n  .filter-card-tooltip {\n    &.ant-tooltip-placement-bottom {\n      padding-top: 0;\n      & .ant-tooltip-arrow {\n        top: -13px;\n      }\n    }\n  }\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FC, useEffect, useMemo, useRef, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {\n  CategoricalColorNamespace,\n  FeatureFlag,\n  getSharedLabelColor,\n  isFeatureEnabled,\n  SharedLabelColorSource,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport pick from 'lodash/pick';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Global } from '@emotion/react';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport Loading from 'src/components/Loading';\nimport FilterBoxMigrationModal from 'src/dashboard/components/FilterBoxMigrationModal';\nimport {\n  useDashboard,\n  useDashboardCharts,\n  useDashboardDatasets,\n} from 'src/hooks/apiResources';\nimport { hydrateDashboard } from 'src/dashboard/actions/hydrate';\nimport { setDatasources } from 'src/dashboard/actions/datasources';\nimport injectCustomCss from 'src/dashboard/util/injectCustomCss';\nimport setupPlugins from 'src/setup/setupPlugins';\nimport { UserWithPermissionsAndRoles } from 'src/types/bootstrapTypes';\nimport { addWarningToast } from 'src/components/MessageToasts/actions';\n\nimport {\n  getItem,\n  LocalStorageKeys,\n  setItem,\n} from 'src/utils/localStorageHelpers';\nimport {\n  FILTER_BOX_MIGRATION_STATES,\n  FILTER_BOX_TRANSITION_SNOOZE_DURATION,\n} from 'src/explore/constants';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { canUserEditDashboard } from 'src/dashboard/util/permissionUtils';\nimport { getFilterSets } from 'src/dashboard/actions/nativeFilters';\nimport { setDatasetsStatus } from 'src/dashboard/actions/dashboardState';\nimport {\n  getFilterValue,\n  getPermalinkValue,\n} from 'src/dashboard/components/nativeFilters/FilterBar/keyValue';\nimport { filterCardPopoverStyle, headerStyles } from 'src/dashboard/styles';\nimport { DashboardContextForExplore } from 'src/types/DashboardContextForExplore';\nimport shortid from 'shortid';\nimport { RootState } from '../types';\nimport { getActiveFilters } from '../util/activeDashboardFilters';\n\nexport const MigrationContext = React.createContext(\n  FILTER_BOX_MIGRATION_STATES.NOOP,\n);\n\nexport const DashboardPageIdContext = React.createContext('');\n\nsetupPlugins();\nconst DashboardContainer = React.lazy(\n  () =>\n    import(\n      /* webpackChunkName: \"DashboardContainer\" */\n      /* webpackPreload: true */\n      'src/dashboard/containers/Dashboard'\n    ),\n);\n\nconst originalDocumentTitle = document.title;\n\ntype PageProps = {\n  idOrSlug: string;\n};\n\nconst getDashboardContextLocalStorage = () => {\n  const dashboardsContexts = getItem(\n    LocalStorageKeys.dashboard__explore_context,\n    {},\n  );\n  // A new dashboard tab id is generated on each dashboard page opening.\n  // We mark ids as redundant when user leaves the dashboard, because they won't be reused.\n  // Then we remove redundant dashboard contexts from local storage in order not to clutter it\n  return Object.fromEntries(\n    Object.entries(dashboardsContexts).filter(\n      ([, value]) => !value.isRedundant,\n    ),\n  );\n};\n\nconst updateDashboardTabLocalStorage = (\n  dashboardPageId: string,\n  dashboardContext: DashboardContextForExplore,\n) => {\n  const dashboardsContexts = getDashboardContextLocalStorage();\n  setItem(LocalStorageKeys.dashboard__explore_context, {\n    ...dashboardsContexts,\n    [dashboardPageId]: dashboardContext,\n  });\n};\n\nconst useSyncDashboardStateWithLocalStorage = () => {\n  const dashboardPageId = useMemo(() => shortid.generate(), []);\n  const dashboardContextForExplore = useSelector<\n    RootState,\n    DashboardContextForExplore\n  >(({ dashboardInfo, dashboardState, nativeFilters, dataMask }) => ({\n    labelColors: dashboardInfo.metadata?.label_colors || {},\n    sharedLabelColors: dashboardInfo.metadata?.shared_label_colors || {},\n    colorScheme: dashboardState?.colorScheme,\n    chartConfiguration: dashboardInfo.metadata?.chart_configuration || {},\n    nativeFilters: Object.entries(nativeFilters.filters).reduce(\n      (acc, [key, filterValue]) => ({\n        ...acc,\n        [key]: pick(filterValue, ['chartsInScope']),\n      }),\n      {},\n    ),\n    dataMask,\n    dashboardId: dashboardInfo.id,\n    filterBoxFilters: getActiveFilters(),\n    dashboardPageId,\n  }));\n\n  useEffect(() => {\n    updateDashboardTabLocalStorage(dashboardPageId, dashboardContextForExplore);\n    return () => {\n      // mark tab id as redundant when dashboard unmounts - case when user opens\n      // Explore in the same tab\n      updateDashboardTabLocalStorage(dashboardPageId, {\n        ...dashboardContextForExplore,\n        isRedundant: true,\n      });\n    };\n  }, [dashboardContextForExplore, dashboardPageId]);\n  return dashboardPageId;\n};\n\nexport const DashboardPage: FC<PageProps> = ({ idOrSlug }: PageProps) => {\n  const dispatch = useDispatch();\n  const theme = useTheme();\n  const history = useHistory();\n  const user = useSelector<any, UserWithPermissionsAndRoles>(\n    state => state.user,\n  );\n  const dashboardPageId = useSyncDashboardStateWithLocalStorage();\n  const { addDangerToast } = useToasts();\n  const { result: dashboard, error: dashboardApiError } =\n    useDashboard(idOrSlug);\n  const { result: charts, error: chartsApiError } =\n    useDashboardCharts(idOrSlug);\n  const {\n    result: datasets,\n    error: datasetsApiError,\n    status,\n  } = useDashboardDatasets(idOrSlug);\n  const isDashboardHydrated = useRef(false);\n\n  const error = dashboardApiError || chartsApiError;\n  const readyToRender = Boolean(dashboard && charts);\n  const migrationStateParam = getUrlParam(\n    URL_PARAMS.migrationState,\n  ) as FILTER_BOX_MIGRATION_STATES;\n  const isMigrationEnabled = isFeatureEnabled(\n    FeatureFlag.ENABLE_FILTER_BOX_MIGRATION,\n  );\n  const { dashboard_title, css, metadata, id = 0 } = dashboard || {};\n  const [filterboxMigrationState, setFilterboxMigrationState] = useState(\n    migrationStateParam || FILTER_BOX_MIGRATION_STATES.NOOP,\n  );\n\n  useEffect(() => {\n    // mark tab id as redundant when user closes browser tab - a new id will be\n    // generated next time user opens a dashboard and the old one won't be reused\n    const handleTabClose = () => {\n      const dashboardsContexts = getDashboardContextLocalStorage();\n      setItem(LocalStorageKeys.dashboard__explore_context, {\n        ...dashboardsContexts,\n        [dashboardPageId]: {\n          ...dashboardsContexts[dashboardPageId],\n          isRedundant: true,\n        },\n      });\n    };\n    window.addEventListener('beforeunload', handleTabClose);\n    return () => {\n      window.removeEventListener('beforeunload', handleTabClose);\n    };\n  }, [dashboardPageId]);\n\n  useEffect(() => {\n    dispatch(setDatasetsStatus(status));\n  }, [dispatch, status]);\n\n  useEffect(() => {\n    // should convert filter_box to filter component?\n    const hasFilterBox = charts?.some(\n      chart => chart.form_data?.viz_type === 'filter_box',\n    );\n    const canEdit = dashboard && canUserEditDashboard(dashboard, user);\n\n    if (canEdit) {\n      // can user edit dashboard?\n      if (metadata?.native_filter_configuration) {\n        setFilterboxMigrationState(\n          isMigrationEnabled\n            ? FILTER_BOX_MIGRATION_STATES.CONVERTED\n            : FILTER_BOX_MIGRATION_STATES.NOOP,\n        );\n        return;\n      }\n\n      // set filterbox migration state if has filter_box in the dash:\n      if (hasFilterBox) {\n        if (isMigrationEnabled) {\n          // has url param?\n          if (\n            migrationStateParam &&\n            Object.values(FILTER_BOX_MIGRATION_STATES).includes(\n              migrationStateParam,\n            )\n          ) {\n            setFilterboxMigrationState(migrationStateParam);\n            return;\n          }\n\n          // has cookie?\n          const snoozeDash = getItem(\n            LocalStorageKeys.filter_box_transition_snoozed_at,\n            {},\n          );\n          if (\n            Date.now() - (snoozeDash[id] || 0) <\n            FILTER_BOX_TRANSITION_SNOOZE_DURATION\n          ) {\n            setFilterboxMigrationState(FILTER_BOX_MIGRATION_STATES.SNOOZED);\n            return;\n          }\n\n          setFilterboxMigrationState(FILTER_BOX_MIGRATION_STATES.UNDECIDED);\n        } else if (isFeatureEnabled(FeatureFlag.DASHBOARD_NATIVE_FILTERS)) {\n          dispatch(\n            addWarningToast(\n              t(\n                'filter_box will be deprecated ' +\n                  'in a future version of Superset. ' +\n                  'Please replace filter_box by dashboard filter components.',\n              ),\n            ),\n          );\n        }\n      }\n    }\n  }, [readyToRender]);\n\n  useEffect(() => {\n    // eslint-disable-next-line consistent-return\n    async function getDataMaskApplied() {\n      const permalinkKey = getUrlParam(URL_PARAMS.permalinkKey);\n      const nativeFilterKeyValue = getUrlParam(URL_PARAMS.nativeFiltersKey);\n      const isOldRison = getUrlParam(URL_PARAMS.nativeFilters);\n\n      let dataMask = nativeFilterKeyValue || {};\n      // activeTabs is initialized with undefined so that it doesn't override\n      // the currently stored value when hydrating\n      let activeTabs: string[] | undefined;\n      if (permalinkKey) {\n        const permalinkValue = await getPermalinkValue(permalinkKey);\n        if (permalinkValue) {\n          ({ dataMask, activeTabs } = permalinkValue.state);\n        }\n      } else if (nativeFilterKeyValue) {\n        dataMask = await getFilterValue(id, nativeFilterKeyValue);\n      }\n      if (isOldRison) {\n        dataMask = isOldRison;\n      }\n\n      if (readyToRender) {\n        if (!isDashboardHydrated.current) {\n          isDashboardHydrated.current = true;\n          if (isFeatureEnabled(FeatureFlag.DASHBOARD_NATIVE_FILTERS_SET)) {\n            // only initialize filterset once\n            dispatch(getFilterSets(id));\n          }\n        }\n        dispatch(\n          hydrateDashboard({\n            history,\n            dashboard,\n            charts,\n            activeTabs,\n            filterboxMigrationState,\n            dataMask,\n          }),\n        );\n      }\n      return null;\n    }\n    if (id) getDataMaskApplied();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [readyToRender, filterboxMigrationState]);\n\n  useEffect(() => {\n    if (dashboard_title) {\n      document.title = dashboard_title;\n    }\n    return () => {\n      document.title = originalDocumentTitle;\n    };\n  }, [dashboard_title]);\n\n  useEffect(() => {\n    if (typeof css === 'string') {\n      // returning will clean up custom css\n      // when dashboard unmounts or changes\n      return injectCustomCss(css);\n    }\n    return () => {};\n  }, [css]);\n\n  useEffect(() => {\n    const sharedLabelColor = getSharedLabelColor();\n    sharedLabelColor.source = SharedLabelColorSource.dashboard;\n    return () => {\n      // clean up label color\n      const categoricalNamespace = CategoricalColorNamespace.getNamespace(\n        metadata?.color_namespace,\n      );\n      categoricalNamespace.resetColors();\n      sharedLabelColor.clear();\n    };\n  }, [metadata?.color_namespace]);\n\n  useEffect(() => {\n    if (datasetsApiError) {\n      addDangerToast(\n        t('Error loading chart datasources. Filters may not work correctly.'),\n      );\n    } else {\n      dispatch(setDatasources(datasets));\n    }\n  }, [addDangerToast, datasets, datasetsApiError, dispatch]);\n\n  if (error) throw error; // caught in error boundary\n  if (!readyToRender) return <Loading />;\n\n  return (\n    <>\n      <Global styles={[filterCardPopoverStyle(theme), headerStyles(theme)]} />\n      <FilterBoxMigrationModal\n        show={filterboxMigrationState === FILTER_BOX_MIGRATION_STATES.UNDECIDED}\n        hideFooter={!isMigrationEnabled}\n        onHide={() => {\n          // cancel button: only snooze this visit\n          setFilterboxMigrationState(FILTER_BOX_MIGRATION_STATES.SNOOZED);\n        }}\n        onClickReview={() => {\n          setFilterboxMigrationState(FILTER_BOX_MIGRATION_STATES.REVIEWING);\n        }}\n        onClickSnooze={() => {\n          const snoozedDash = getItem(\n            LocalStorageKeys.filter_box_transition_snoozed_at,\n            {},\n          );\n          setItem(LocalStorageKeys.filter_box_transition_snoozed_at, {\n            ...snoozedDash,\n            [id]: Date.now(),\n          });\n          setFilterboxMigrationState(FILTER_BOX_MIGRATION_STATES.SNOOZED);\n        }}\n      />\n\n      <MigrationContext.Provider value={filterboxMigrationState}>\n        <DashboardPageIdContext.Provider value={dashboardPageId}>\n          <DashboardContainer />\n        </DashboardPageIdContext.Provider>\n      </MigrationContext.Provider>\n    </>\n  );\n};\n\nexport default DashboardPage;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nfunction createStyleElement(className: string) {\n  const style = document.createElement('style');\n  style.className = className;\n  style.type = 'text/css';\n  return style;\n}\n\n// The original, non-typescript code referenced `style.styleSheet`.\n// I can't find what sort of element would have a styleSheet property,\n// so have created this type to satisfy TS without changing behavior.\ntype MysteryStyleElement = {\n  styleSheet: {\n    cssText: string;\n  };\n};\n\nexport default function injectCustomCss(css: string) {\n  const className = 'CssEditor-css';\n  const head = document.head || document.getElementsByTagName('head')[0];\n  const style: HTMLStyleElement =\n    document.querySelector(`.${className}`) || createStyleElement(className);\n\n  if ('styleSheet' in style) {\n    (style as HTMLStyleElement & MysteryStyleElement).styleSheet.cssText = css;\n  } else {\n    style.innerHTML = css;\n  }\n\n  /**\n   * Ensures that the style applied is always the last.\n   *\n   * from: https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild\n   * The Node.appendChild() method adds a node to the end of the list of children\n   * of a specified parent node. If the given child is a reference to an existing\n   * node in the document, appendChild() moves it from its current position to the\n   * new position (there is no requirement to remove the node from its parent node\n   * before appending it to some other node).\n   */\n\n  head.appendChild(style);\n\n  return function removeCustomCSS() {\n    style.remove();\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport rison from 'rison';\nimport Chart from 'src/types/Chart';\nimport { useApiV1Resource, useTransformedResource } from './apiResources';\n\nfunction extractOwnerNames({ owners }: Chart) {\n  if (!owners) return null;\n  return owners.map(owner => `${owner.first_name} ${owner.last_name}`);\n}\n\nconst ownerNamesQuery = rison.encode({\n  columns: ['owners.first_name', 'owners.last_name'],\n  keys: ['none'],\n});\n\nexport function useChartOwnerNames(chartId: string) {\n  return useTransformedResource(\n    useApiV1Resource<Chart>(`/api/v1/chart/${chartId}?q=${ownerNamesQuery}`),\n    extractOwnerNames,\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Dashboard, Datasource, EmbeddedDashboard } from 'src/dashboard/types';\nimport { Chart } from 'src/types/Chart';\nimport { useApiV1Resource, useTransformedResource } from './apiResources';\n\nexport const useDashboard = (idOrSlug: string | number) =>\n  useTransformedResource(\n    useApiV1Resource<Dashboard>(`/api/v1/dashboard/${idOrSlug}`),\n    dashboard => ({\n      ...dashboard,\n      // TODO: load these at the API level\n      metadata:\n        (dashboard.json_metadata && JSON.parse(dashboard.json_metadata)) || {},\n      position_data:\n        dashboard.position_json && JSON.parse(dashboard.position_json),\n    }),\n  );\n\n// gets the chart definitions for a dashboard\nexport const useDashboardCharts = (idOrSlug: string | number) =>\n  useApiV1Resource<Chart[]>(`/api/v1/dashboard/${idOrSlug}/charts`);\n\n// gets the datasets for a dashboard\n// important: this endpoint only returns the fields in the dataset\n// that are necessary for rendering the given dashboard\nexport const useDashboardDatasets = (idOrSlug: string | number) =>\n  useApiV1Resource<Datasource[]>(`/api/v1/dashboard/${idOrSlug}/datasets`);\n\nexport const useEmbeddedDashboard = (idOrSlug: string | number) =>\n  useApiV1Resource<EmbeddedDashboard>(`/api/v1/dashboard/${idOrSlug}/embedded`);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useRef } from 'react';\nimport { useQuery, UseQueryOptions } from 'react-query';\nimport rison from 'rison';\nimport { SupersetClient } from '@superset-ui/core';\n\nexport type FetchSchemasQueryParams = {\n  dbId?: string | number;\n  forceRefresh?: boolean;\n};\n\ntype QueryData = {\n  json: { result: string[] };\n  response: Response;\n};\n\nexport type SchemaOption = {\n  value: string;\n  label: string;\n  title: string;\n};\n\nexport function fetchSchemas({ dbId, forceRefresh }: FetchSchemasQueryParams) {\n  const queryParams = rison.encode({ force: forceRefresh });\n  // TODO: Would be nice to add pagination in a follow-up. Needs endpoint changes.\n  const endpoint = `/api/v1/database/${dbId}/schemas/?q=${queryParams}`;\n  return SupersetClient.get({ endpoint }) as Promise<QueryData>;\n}\n\ntype Params = FetchSchemasQueryParams &\n  Pick<UseQueryOptions<SchemaOption[]>, 'onSuccess' | 'onError'>;\n\nexport function useSchemas(options: Params) {\n  const { dbId, onSuccess, onError } = options || {};\n  const forceRefreshRef = useRef(false);\n  const params = { dbId };\n  const result = useQuery<QueryData, Error, SchemaOption[]>(\n    ['schemas', { dbId }],\n    () => fetchSchemas({ ...params, forceRefresh: forceRefreshRef.current }),\n    {\n      select: ({ json }) =>\n        json.result.map((value: string) => ({\n          value,\n          label: value,\n          title: value,\n        })),\n      enabled: Boolean(dbId),\n      onSuccess,\n      onError,\n      onSettled: () => {\n        forceRefreshRef.current = false;\n      },\n    },\n  );\n\n  return {\n    ...result,\n    refetch: () => {\n      forceRefreshRef.current = true;\n      return result.refetch();\n    },\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useRef, useMemo } from 'react';\nimport { useQuery, UseQueryOptions } from 'react-query';\nimport rison from 'rison';\nimport { SupersetClient } from '@superset-ui/core';\n\nimport { useSchemas } from './schemas';\n\nexport type FetchTablesQueryParams = {\n  dbId?: string | number;\n  schema?: string;\n  forceRefresh?: boolean;\n};\nexport interface Table {\n  label: string;\n  value: string;\n  type: string;\n  extra?: {\n    certification?: {\n      certified_by: string;\n      details: string;\n    };\n    warning_markdown?: string;\n  };\n}\n\ntype QueryData = {\n  json: {\n    count: number;\n    result: Table[];\n  };\n  response: Response;\n};\n\nexport type Data = {\n  options: Table[];\n  hasMore: boolean;\n};\n\nexport function fetchTables({\n  dbId,\n  schema,\n  forceRefresh,\n}: FetchTablesQueryParams) {\n  const encodedSchema = schema ? encodeURIComponent(schema) : '';\n  const params = rison.encode({\n    force: forceRefresh,\n    schema_name: encodedSchema,\n  });\n\n  // TODO: Would be nice to add pagination in a follow-up. Needs endpoint changes.\n  const endpoint = `/api/v1/database/${\n    dbId ?? 'undefined'\n  }/tables/?q=${params}`;\n  return SupersetClient.get({ endpoint }) as Promise<QueryData>;\n}\n\ntype Params = FetchTablesQueryParams &\n  Pick<UseQueryOptions<Data>, 'onSuccess' | 'onError'>;\n\nexport function useTables(options: Params) {\n  const { data: schemaOptions, isFetching } = useSchemas({\n    dbId: options.dbId,\n  });\n  const schemaOptionsMap = useMemo(\n    () => new Set(schemaOptions?.map(({ value }) => value)),\n    [schemaOptions],\n  );\n  const { dbId, schema, onSuccess, onError } = options || {};\n  const forceRefreshRef = useRef(false);\n  const params = { dbId, schema };\n  const result = useQuery<QueryData, Error, Data>(\n    ['tables', { dbId, schema }],\n    () => fetchTables({ ...params, forceRefresh: forceRefreshRef.current }),\n    {\n      select: ({ json }) => ({\n        options: json.result,\n        hasMore: json.count > json.result.length,\n      }),\n      enabled: Boolean(\n        dbId && schema && !isFetching && schemaOptionsMap.has(schema),\n      ),\n      onSuccess,\n      onError,\n      onSettled: () => {\n        forceRefreshRef.current = false;\n      },\n    },\n  );\n\n  return {\n    ...result,\n    refetch: () => {\n      forceRefreshRef.current = true;\n      return result.refetch();\n    },\n  };\n}\n"],"names":["assembleEndpoint","dashId","key","tabId","endpoint","concat","updateFilterKey","value","SupersetClient","jsonPayload","then","r","json","message","catch","err","logging","createFilterKey","undefined","getFilterValue","JSON","parse","getPermalinkValue","StyledFilterBoxMigrationModal","styled","Modal","onClickReview","onClickSnooze","onHide","show","hideFooter","title","t","footer","Button","buttonSize","onClick","buttonStyle","responsive","headerStyles","theme","css","typography","weights","bold","sizes","xxl","gridUnit","xl","l","filterCardPopoverStyle","MigrationContext","React","FILTER_BOX_MIGRATION_STATES","DashboardPageIdContext","setupPlugins","DashboardContainer","originalDocumentTitle","document","getDashboardContextLocalStorage","dashboardsContexts","getItem","LocalStorageKeys","Object","fromEntries","entries","filter","isRedundant","updateDashboardTabLocalStorage","dashboardPageId","dashboardContext","setItem","DashboardPage","idOrSlug","dispatch","useDispatch","useTheme","history","useHistory","user","useSelector","state","useMemo","shortid","dashboardContextForExplore","dashboardInfo","dashboardState","nativeFilters","dataMask","labelColors","metadata","label_colors","sharedLabelColors","shared_label_colors","colorScheme","chartConfiguration","chart_configuration","filters","reduce","acc","filterValue","pick","dashboardId","id","filterBoxFilters","getActiveFilters","useEffect","useSyncDashboardStateWithLocalStorage","addDangerToast","useToasts","result","dashboard","error","dashboardApiError","useDashboard","charts","chartsApiError","useDashboardCharts","datasets","datasetsApiError","status","useDashboardDatasets","isDashboardHydrated","useRef","readyToRender","Boolean","migrationStateParam","getUrlParam","URL_PARAMS","isMigrationEnabled","isFeatureEnabled","FeatureFlag","dashboard_title","filterboxMigrationState","setFilterboxMigrationState","useState","handleTabClose","window","addEventListener","removeEventListener","setDatasetsStatus","hasFilterBox","some","chart","form_data","viz_type","canUserEditDashboard","native_filter_configuration","values","snoozeDash","Date","now","FILTER_BOX_TRANSITION_SNOOZE_DURATION","addWarningToast","async","permalinkKey","nativeFilterKeyValue","isOldRison","activeTabs","permalinkValue","current","getFilterSets","hydrateDashboard","getDataMaskApplied","injectCustomCss","sharedLabelColor","getSharedLabelColor","source","SharedLabelColorSource","CategoricalColorNamespace","getNamespace","color_namespace","resetColors","clear","setDatasources","styles","snoozedDash","Provider","Loading","className","head","getElementsByTagName","style","querySelector","createElement","type","createStyleElement","styleSheet","cssText","innerHTML","appendChild","remove","extractOwnerNames","owners","map","owner","first_name","last_name","ownerNamesQuery","rison","columns","keys","useChartOwnerNames","chartId","useTransformedResource","useApiV1Resource","json_metadata","position_data","position_json","useSchemas","options","dbId","onSuccess","onError","forceRefreshRef","params","useQuery","forceRefresh","force","fetchSchemas","select","label","enabled","onSettled","refetch","useTables","data","schemaOptions","isFetching","schemaOptionsMap","Set","schema","encodedSchema","encodeURIComponent","schema_name","fetchTables","hasMore","count","length","has"],"sourceRoot":""}