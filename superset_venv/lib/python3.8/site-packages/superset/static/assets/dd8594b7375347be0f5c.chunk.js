"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[704],{33738:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var n=r(78580),l=r.n(n),a=r(67294),s=r(16355),u=r(5364),c=r(63475),i=r(6915),o=r(11965);function h(e){let{height:t,width:r,echartOptions:n,setDataMask:h,labelMap:d,labelMapB:f,groupby:p,groupbyB:g,selectedValues:m,formData:v,emitCrossFilters:b,seriesBreakdown:w,onContextMenu:y,xValueFormatter:k,xAxis:x,refs:I}=e;const E=(0,a.useCallback)((e=>e<w),[w]),O=(0,a.useCallback)(((e,t)=>{if(!b)return;const r=E(t)?p:g,n=E(t)?d:f,l=e.map((e=>null==n?void 0:n[e])).filter((e=>!!e));h({extraFormData:{filters:0===e.length?[]:[...r.map(((e,t)=>{const r=l.map((e=>e[t]));return null==r?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:r}}))]},filterState:{value:l.length?l:null,selectedValues:e.length?e:null}})}),[p,g,d,f,h,m]),C={click:e=>{const{seriesName:t,seriesIndex:r}=e,n=Object.values(m||{});l()(n).call(n,t)?O(n.filter((e=>e!==t)),r):O([t],r)},mouseout:()=>{i.aI.name=""},mouseover:e=>{i.aI.name=e.seriesName},contextmenu:e=>{if(y){e.event.stop();const{data:t,seriesIndex:r}=e;if(t){const n=e.event.event,l=[...e.name?[e.name]:[],...(E(r)?d:f)[e.seriesName]],a=[];x.type===s.we.time&&a.push({col:x.label===u.W3?v.granularitySqla:x.label,grain:v.timeGrainSqla,op:"==",val:t[0],formattedVal:k(t[0])}),[...x.type===s.we.category?[x.label]:[],...E(r)?v.groupby:v.groupbyB].forEach(((e,t)=>a.push({col:e,op:"==",val:l[t],formattedVal:String(l[t])}))),y(n.clientX,n.clientY,a)}}}};return(0,o.tZ)(c.Z,{refs:I,height:t,width:r,echartOptions:n,eventHandlers:C,selectedValues:m})}},63475:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(78580),l=r.n(n),a=r(67294),s=r(51995),u=r(31431),c=r(11965);const i=s.iK.div`
  height: ${e=>{let{height:t}=e;return t}};
  width: ${e=>{let{width:t}=e;return t}};
`;function o(e,t){let{width:r,height:n,echartOptions:s,eventHandlers:o,zrEventHandlers:h,selectedValues:d={},refs:f}=e;const p=(0,a.useRef)(null);f&&(f.divRef=p);const g=(0,a.useRef)(),m=(0,a.useMemo)((()=>Object.keys(d)||[]),[d]),v=(0,a.useRef)([]);(0,a.useImperativeHandle)(t,(()=>({getEchartInstance:()=>g.current}))),(0,a.useEffect)((()=>{p.current&&(g.current||(g.current=(0,u.S1)(p.current)),Object.entries(o||{}).forEach((e=>{var t,r;let[n,l]=e;null==(t=g.current)||t.off(n),null==(r=g.current)||r.on(n,l)})),Object.entries(h||{}).forEach((e=>{var t,r;let[n,l]=e;null==(t=g.current)||t.getZr().off(n),null==(r=g.current)||r.getZr().on(n,l)})),g.current.setOption(s,!0))}),[s,o,h]),(0,a.useEffect)((()=>{g.current&&(g.current.dispatchAction({type:"downplay",dataIndex:v.current.filter((e=>!l()(m).call(m,e)))}),m.length&&g.current.dispatchAction({type:"highlight",dataIndex:m}),v.current=m)}),[m]);const b=(0,a.useCallback)((e=>{let{width:t,height:r}=e;g.current&&g.current.resize({width:t,height:r})}),[]);return(0,a.useEffect)((()=>(b({width:r,height:n}),()=>{var e;return null==(e=g.current)?void 0:e.dispose()})),[]),(0,a.useLayoutEffect)((()=>{b({width:r,height:n})}),[r,n,b]),(0,c.tZ)(i,{ref:p,height:n,width:r})}const h=(0,a.forwardRef)(o)}}]);
//# sourceMappingURL=dd8594b7375347be0f5c.chunk.js.map