"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[3711],{33711:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var n=r(67294),l=r(63475),c=r(99381),s=r(11965);function u(e){const{height:t,width:r,echartOptions:u,setDataMask:a,labelMap:i,groupby:h,selectedValues:o,refs:d,emitCrossFilters:f}=e,p=(0,n.useCallback)((e=>{if(!f)return;const t=e.map((e=>i[e]));a({extraFormData:{filters:0===e.length?[]:h.map(((e,r)=>{const n=t.map((e=>e[r]));return null==n?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:n}}))},filterState:{value:t.length?t:null,selectedValues:e.length?e:null}})}),[h,i,a,o]),g=(0,c.C0)(e,p);return(0,s.tZ)(l.Z,{refs:d,height:t,width:r,echartOptions:u,eventHandlers:g,selectedValues:o})}},63475:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(78580),l=r.n(n),c=r(67294),s=r(51995),u=r(31431),a=r(11965);const i=s.iK.div`
  height: ${e=>{let{height:t}=e;return t}};
  width: ${e=>{let{width:t}=e;return t}};
`;function h(e,t){let{width:r,height:n,echartOptions:s,eventHandlers:h,zrEventHandlers:o,selectedValues:d={},refs:f}=e;const p=(0,c.useRef)(null);f&&(f.divRef=p);const g=(0,c.useRef)(),v=(0,c.useMemo)((()=>Object.keys(d)||[]),[d]),b=(0,c.useRef)([]);(0,c.useImperativeHandle)(t,(()=>({getEchartInstance:()=>g.current}))),(0,c.useEffect)((()=>{p.current&&(g.current||(g.current=(0,u.S1)(p.current)),Object.entries(h||{}).forEach((e=>{var t,r;let[n,l]=e;null==(t=g.current)||t.off(n),null==(r=g.current)||r.on(n,l)})),Object.entries(o||{}).forEach((e=>{var t,r;let[n,l]=e;null==(t=g.current)||t.getZr().off(n),null==(r=g.current)||r.getZr().on(n,l)})),g.current.setOption(s,!0))}),[s,h,o]),(0,c.useEffect)((()=>{g.current&&(g.current.dispatchAction({type:"downplay",dataIndex:b.current.filter((e=>!l()(v).call(v,e)))}),v.length&&g.current.dispatchAction({type:"highlight",dataIndex:v}),b.current=v)}),[v]);const w=(0,c.useCallback)((e=>{let{width:t,height:r}=e;g.current&&g.current.resize({width:t,height:r})}),[]);return(0,c.useEffect)((()=>(w({width:r,height:n}),()=>{var e;return null==(e=g.current)?void 0:e.dispose()})),[]),(0,c.useLayoutEffect)((()=>{w({width:r,height:n})}),[r,n,w]),(0,a.tZ)(i,{ref:p,height:n,width:r})}const o=(0,c.forwardRef)(h)},99381:(e,t,r)=>{r.d(t,{C0:()=>u});var n=r(78580),l=r.n(n);const c=(e,t)=>r=>{let{name:n}=r;const c=Object.values(e);l()(c).call(c,n)?t(c.filter((e=>e!==n))):t([n])},s=(e,t,r)=>n=>{if(t){n.event.stop();const l=n.event.event,c=[];if(e.length>0){const t=r[n.name];e.forEach(((e,r)=>c.push({col:e,op:"==",val:t[r],formattedVal:String(t[r])})))}t(l.clientX,l.clientY,c)}},u=(e,t)=>{const{groupby:r,selectedValues:n,onContextMenu:l,labelMap:u}=e;return{click:c(n,t),contextmenu:s(r,l,u)}}}}]);
//# sourceMappingURL=464b7f997dbc0ec490ba.chunk.js.map